[
  {
    "id": "JK_TALK_WAKE_UP",
    "type": "talk_topic",
    "dynamic_line": {
      "npc_has_effect": "sleep",
      "yes": {
        "npc_need": "sleepiness",
        "level": "EXHAUSTED",
        "no": {
          "npc_need": "sleepiness",
          "level": "DEAD_TIRED",
          "no": {
            "npc_need": "sleepiness",
            "level": "TIRED",
            "no": "ううん、あと5分……",
            "yes": "センパイ、なんです？　まだ寝たい……"
          },
          "yes": "うう、眠くて死にそうです……"
        },
        "yes": "眠たいです……"
      },
      "no": "あれ、何か忘れてました？"
    },
    "responses": [
      { "text": "(起こす)", "topic": "TALK_NONE", "effect": "wake_up" },
      { "text": "(寝かせておく)", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": [ "JK_TALK_FRIEND", "JK_TALK_GIVE_ITEM", "JK_TALK_USE_ITEM", "JK_TALK_RADIO" ],
    "type": "talk_topic",
    "dynamic_line": {
      "is_by_radio": " ……ザザザ…… センパイ、聞こえますか？",
      "no": {
        "has_reason": { "use_reason": true },
        "no": {
          "//": "ゲーム開始はthe dayから5日後。>=6はゲーム開始翌日を想定。noは一日目のメッセージ",
          "math": [ "time_since('cataclysm', 'unit': 'days') >= 6" ],
          "no": "や～大変でしたね、センパイ",
          "yes": {
            "//": "ミッション2開始前",
            "math": [ "n_jk_mission_status <= 3" ],
            "yes": {
              "//": "にHUB01のインターコムに話しかけ:先行ルート",
              "compare_string": [ { "u_val": "dialogue_intercom_u_discovered_robofac_intercom" }, "yes" ],
              "yes": "<color_yellow>[ミッション]</color>センパイ、HUB01のことなんですけど……",
              "no": {
                "//": "ていなくてミッション1開始前",
                "math": [ "n_jk_mission_status == 1" ],
                "yes": "<color_yellow>[ミッション]</color>センパイ、ちょっと相談があるんですけど……",
                "no": {
                  "//": "ていなくてミッション1を終わらせ(通常ルート)",
                  "math": [ "n_jk_mission_status == 3" ],
                  "yes": "<color_yellow>[ミッション]</color>センパイ、ちょっと思いついたことがあるんですけど……",
                  "no": "どうしたんですか？　センパイ"
                }
              }
            },
            "//2": "ミッション2開始以降",
            "no": {
              "//": "にHUB01のインターコムに話しかけ",
              "compare_string": [ { "u_val": "dialogue_intercom_u_discovered_robofac_intercom" }, "yes" ],
              "yes": {
                "//": "たのがミッション2実行中なら:->M2クリア",
                "math": [ "n_jk_mission_status == 4" ],
                "yes": "<color_yellow>[ミッション]</color>センパイ、HUB01のことなんですけど……",
                "no": {
                  "//": "でなくミッション4まで終わってるなら(通常応答)",
                  "math": [ "n_jk_mission_status == 9" ],
                  "yes": "どうしたんですか？　センパイ",
                  "no": {
                    "//": "でなくミッション3まで終わってるなら",
                    "compare_string": [ { "u_val": "jk_m4_ready" }, "yes" ],
                    "yes": "<color_yellow>[ミッション]</color>センパイ！ ママのこと分かったんですね！",
                    "no": "どうしたんですか？　センパイ"
                  }
                }
              },
              "//2": "↓はミッション2実行中でHUB探索中",
              "no": "どうしたんですか？　センパイ"
            }
          }
        }
      }
    },
    "responses": [
      {
        "text": "<color_yellow>[ミッション]</color>(ここだ……)",
        "topic": "JK_TALK_MISSION4_COMPLETE",
        "condition": {
          "and": [
            { "u_has_mission": "JK_MISSION_FIND_LABO_4" },
            { "u_at_om_location": "central_lab_entrance" },
            { "npc_at_om_location": "central_lab_entrance" }
          ]
        },
        "switch": true
      },
      {
        "text": "<color_yellow>[ミッション]</color>(アリーヤ博士の行方について)",
        "topic": "JK_TALK_MISSION4_INQUIRE",
        "condition": { "u_has_mission": "JK_MISSION_FIND_LABO_4" },
        "switch": true
      },
      {
        "//": "M3クリアの場合",
        "text": "<color_yellow>[ミッション]</color>(アリーヤ博士の行方について)",
        "topic": "JK_TALK_MISSION4",
        "condition": {
          "and": [ { "compare_string": [ { "u_val": "jk_m4_ready" }, "yes" ] }, { "u_has_mission": "JK_MISSION_FIND_LABO_3" } ]
        },
        "switch": true,
        "effect": [
          { "finish_mission": "JK_MISSION_FIND_LABO_3", "success": true },
          "clear_mission",
          { "u_add_var": "jk_clear_mission3", "value": "done" },
          { "math": [ "n_jk_mission_status = 8" ] },
          {
            "u_message": "ミッション: 「<color_light_blue>HUB01の信用を得るには</color>」を完了しました",
            "popup": true
          }
        ]
      },
      {
        "//": "M2からスキップの場合",
        "text": "<color_yellow>[ミッション]</color>(アリーヤ博士の行方について)",
        "topic": "JK_TALK_MISSION4",
        "condition": {
          "and": [ { "compare_string": [ { "u_val": "jk_m4_ready" }, "yes" ] }, { "u_has_mission": "JK_MISSION_FIND_LABO_2" } ]
        },
        "switch": true,
        "effect": [
          { "finish_mission": "JK_MISSION_FIND_LABO_2", "success": true },
          "clear_mission",
          { "u_add_var": "jk_clear_mission2", "value": "done" },
          { "math": [ "n_jk_mission_status = 8" ] },
          {
            "u_message": "ミッション: 「<color_light_blue>HUB01に行こう</color>」を完了しました",
            "popup": true
          }
        ]
      },
      {
        "text": "<color_yellow>[ミッション]</color>(相談を聞く)",
        "topic": "JK_TALK_MISSION2_FAST",
        "condition": {
          "//": "ミッション2開始前にHUB01のインターコムに話しかけ:先行ルートでミッション2開始",
          "and": [
            { "not": { "math": [ "n_jk_mission_status == 0" ] } },
            { "math": [ "n_jk_mission_status <= 3" ] },
            { "compare_string": [ { "u_val": "dialogue_intercom_u_discovered_robofac_intercom" }, "yes" ] }
          ]
        },
        "switch": true
      },
      {
        "text": "<color_yellow>[ミッション]</color>(聞く耳を持たないようだ)",
        "topic": "JK_TALK_MISSION2_COMPLETE",
        "condition": {
          "//": "ミッション2の間に完了条件(アリーヤ博士の娘が……)を聞いた(通常ルート)",
          "and": [
            { "u_has_mission": "JK_MISSION_FIND_LABO_2" },
            { "compare_string": [ { "u_val": "jk_mission2_talk_hub1" }, "done" ] }
          ]
        },
        "switch": true
      },
      {
        "text": "<color_yellow>[ミッション]</color>(相談を聞く)",
        "//": "ミッション1完了時にまだHUB01のインターコムに話しかけてない(通常ルート)",
        "topic": "JK_TALK_MISSION2",
        "condition": { "math": [ "n_jk_mission_status == 3" ] },
        "switch": true
      },
      {
        "text": "<color_yellow>[ミッション]</color>(相談を聞く)",
        "topic": "JK_TALK_MISSION1",
        "condition": {
          "//": "第一ミッション開始前",
          "and": [ { "math": [ "n_jk_mission_status == 1" ] }, { "math": [ "time_since('cataclysm', 'unit': 'days') >= 6" ] } ]
        },
        "switch": true
      },
      {
        "text": "<color_yellow>[ミッション]</color>(研究所に着いた……)",
        "topic": "JK_TALK_MISSION1_COMPLETE",
        "condition": {
          "and": [
            { "u_has_mission": "JK_MISSION_FIND_LABO_1" },
            { "u_at_om_location": "lab_stairs" },
            { "npc_at_om_location": "lab_stairs" }
          ]
        },
        "switch": true
      },
      {
        "text": "<color_yellow>[ミッション]</color>(相談について)",
        "topic": "JK_TALK_MISSION1_INQUIRE",
        "condition": { "u_has_mission": "JK_MISSION_FIND_LABO_1" },
        "switch": true
      },
      {
        "//": "HUB01: 実地データ回収中",
        "text": "<color_yellow>[ミッション]</color>(実地データの回収について話す)",
        "topic": "JK_TALK_MISSION3_INQUIRE_ROBOFAC1",
        "condition": { "and": [ { "u_has_mission": "JK_MISSION_FIND_LABO_3" }, { "u_has_mission": "MISSION_ROBOFAC_INTERCOM_1" } ] }
      },
      {
        "//": "HUB01: 無言の帰還中",
        "text": "<color_yellow>[ミッション]</color>(無言の帰還について話す)",
        "topic": "JK_TALK_MISSION3_INQUIRE_ROBOFAC2",
        "condition": { "and": [ { "u_has_mission": "JK_MISSION_FIND_LABO_3" }, { "u_has_mission": "MISSION_ROBOFAC_INTERCOM_2" } ] }
      },
      {
        "//": "HUB01: 鉄塊狩り中",
        "text": "<color_yellow>[ミッション]</color>(鉄塊狩りについて話す)",
        "topic": "JK_TALK_MISSION3_INQUIRE_ROBOFAC3",
        "condition": { "and": [ { "u_has_mission": "JK_MISSION_FIND_LABO_3" }, { "u_has_mission": "MISSION_ROBOFAC_INTERCOM_ROBOT_SM_1" } ] }
      },
      {
        "//": "HUB01: 輝かしい回収",
        "text": "<color_yellow>[ミッション]</color>(輝かしい捜索任務について話す)",
        "topic": "JK_TALK_MISSION3_INQUIRE_ROBOFAC4",
        "condition": { "and": [ { "u_has_mission": "JK_MISSION_FIND_LABO_3" }, { "u_has_mission": "MISSION_ROBOFAC_INTERCOM_3" } ] }
      },
      {
        "text": "<color_yellow>[ミッション]</color>(相談について)",
        "topic": "JK_TALK_MISSION3_INQUIRE",
        "//": "M3中で、実地データ回収を承けたら止める。",
        "condition": {
          "and": [
            { "u_has_mission": "JK_MISSION_FIND_LABO_3" },
            {
              "or": [
                { "not": { "u_has_mission": "MISSION_ROBOFAC_INTERCOM_1" } },
                {
                  "not": { "compare_string": [ { "u_val": "dialogue_intercom_completed_robofac_intercom_1" }, "yes" ] }
                }
              ]
            }
          ]
        },
        "switch": true
      },
      {
        "text": "<color_yellow>[ミッション]</color>(HUB01はここだ)",
        "topic": "JK_TALK_MISSION2_INQUIRE2",
        "condition": {
          "and": [
            {
              "or": [
                { "u_at_om_location": "robofachq_surface_parking" },
                { "u_at_om_location": "robofachq_surface_entrance" },
                { "u_at_om_location": "robofachq_surface_car_entrance" },
                { "u_at_om_location": "robofachq_meteorology0" },
                { "u_at_om_location": "robofachq_meteorology1" },
                { "u_at_om_location": "robofachq_meteorology2" },
                { "u_at_om_location": "robofachq_meteorology3" },
                { "u_at_om_location": "robofachq_surface_road0" },
                { "u_at_om_location": "robofachq_surface_road1" },
                { "u_at_om_location": "robofachq_surface_road2" },
                { "u_at_om_location": "robofachq_surface_road3" },
                { "u_at_om_location": "robofachq_surface_b0" },
                { "u_at_om_location": "robofachq_surface_b1" },
                { "u_at_om_location": "robofachq_surface_b2" },
                { "u_at_om_location": "robofachq_surface_b3" }
              ]
            },
            {
              "or": [
                { "npc_at_om_location": "robofachq_surface_parking" },
                { "npc_at_om_location": "robofachq_surface_entrance" },
                { "npc_at_om_location": "robofachq_surface_car_entrance" },
                { "npc_at_om_location": "robofachq_meteorology0" },
                { "npc_at_om_location": "robofachq_meteorology1" },
                { "npc_at_om_location": "robofachq_meteorology2" },
                { "npc_at_om_location": "robofachq_meteorology3" },
                { "npc_at_om_location": "robofachq_surface_road0" },
                { "npc_at_om_location": "robofachq_surface_road1" },
                { "npc_at_om_location": "robofachq_surface_road2" },
                { "npc_at_om_location": "robofachq_surface_road3" },
                { "npc_at_om_location": "robofachq_surface_b0" },
                { "npc_at_om_location": "robofachq_surface_b1" },
                { "npc_at_om_location": "robofachq_surface_b2" },
                { "npc_at_om_location": "robofachq_surface_b3" }
              ]
            },
            { "u_has_mission": "JK_MISSION_FIND_LABO_2" }
          ]
        },
        "switch": true
      },
      {
        "text": "<color_yellow>[ミッション]</color>(相談について)",
        "topic": "JK_TALK_MISSION2_INQUIRE",
        "condition": { "u_has_mission": "JK_MISSION_FIND_LABO_2" },
        "switch": true
      },
      { "text": "(話をする)", "topic": "JK_TALK_ALLY_SOCIAL", "default": true },
      { "text": "(指示を出す)", "topic": "JK_TALK_ALLY_ORDERS" },
      { "text": "(指定の場所へ移動させる)", "topic": "JK_TALK_GOTO_LOCATION", "effect": "goto_location" },
      { "text": "([行動規制] 行動ルールを設定する)", "topic": "TALK_DONE", "effect": "npc_rules_menu" },
      { "text": "(ステータスを見る)", "topic": "JK_TALK_FRIEND", "effect": "reveal_stats" },
      {
        "text": "[DEBUG MIND CONTROL] Now listen closely… (DEBUG FUNCTIONS)",
        "condition": { "u_has_trait": "DEBUG_MIND_CONTROL" },
        "topic": "TALK_ALLY_DEBUG"
      },
      { "text": "(会話終了)", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": [ "JK_TALK_ALLY_SOCIAL" ],
    "type": "talk_topic",
    "dynamic_line": {
      "is_by_radio": " *ザザッ* センパイ、電池がもったいないのでお話は戻ってからにしませんか？",
      "no": "お話ししましょう！"
    },
    "responses": [
      {
        "text": "(気分転換に雑談に誘う)",
        "topic": "JK_TALK_MISSION1_AFTER",
        "switch": true,
        "condition": {
          "and": [
            { "not": { "npc_has_effect": "asked_to_socialize" } },
            "at_safe_space",
            { "compare_string": [ "done", { "u_val": "jk_clear_mission1" } ] }
          ]
        }
      },
      {
        "text": "(気分転換に雑談に誘う)",
        "topic": "JK_TALK_MISSION2_AFTER",
        "switch": true,
        "condition": {
          "and": [
            { "not": { "npc_has_effect": "asked_to_socialize" } },
            "at_safe_space",
            { "compare_string": [ "done", { "u_val": "jk_clear_mission2" } ] }
          ]
        }
      },
      {
        "text": "(気分転換に雑談に誘う)",
        "topic": "JK_TALK_MISSION3_AFTER",
        "switch": true,
        "condition": {
          "and": [
            { "not": { "npc_has_effect": "asked_to_socialize" } },
            "at_safe_space",
            { "compare_string": [ "done", { "u_val": "jk_clear_mission3" } ] }
          ]
        }
      },
      {
        "text": "(気分転換に雑談に誘う)",
        "topic": "JK_TALK_MISSION4_AFTER",
        "switch": true,
        "condition": {
          "and": [
            { "not": { "npc_has_effect": "asked_to_socialize" } },
            "at_safe_space",
            { "compare_string": [ "done", { "u_val": "jk_clear_mission4" } ] }
          ]
        }
      },
      {
        "//": "デフォルトチャット",
        "text": "(気分転換に雑談に誘う)",
        "topic": "JK_TALK_FRIEND_CHAT",
        "switch": true,
        "default": true,
        "condition": { "and": [ { "not": { "npc_has_effect": "asked_to_socialize" } }, "at_safe_space" ] }
      },
      {
        "text": "(出会うまでの話を聞く)",
        "topic": "JK_TALK_FRIEND_CONVERSATION",
        "condition": { "and": [ "at_safe_space", { "not": { "compare_string": [ "done", { "npc_val": "n_jk_told_backstory" } ] } } ] }
      },
      {
        "text": "(出会うまでの話を聞く)",
        "topic": "JK_TALK_FRIEND_CONVERSATION_1",
        "condition": { "and": [ "at_safe_space", { "compare_string": [ "done", { "npc_val": "n_jk_told_backstory" } ] } ] }
      },
      {
        "text": "(出会うまでの話を聞く)",
        "topic": "JK_TALK_CONVERSATION_DANGER",
        "condition": { "not": "at_safe_space" }
      },
      { "text": "(戻る)", "topic": "TALK_NONE" },
      { "text": "(会話終了)", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "JK_TALK_CONVERSATION_DANGER",
    "type": "talk_topic",
    "dynamic_line": {
      "gendered_line": "今ですかセンパイ？　ちょっとマズくないですか…",
      "relevant_genders": [ "u" ]
    },
    "responses": [
      {
        "text": "(問題ない)",
        "topic": "JA_TALK_FRIEND_CONVERSATION",
        "condition": { "not": { "compare_string": [ "done", { "npc_val": "n_jk_told_backstory" } ] } },
        "//": "If the NPC already has a BG story, or started out as a static NPC (and so probably doesn't need a random bg story), then go on.",
        "switch": true
      },
      {
        "text": "(問題ない)",
        "topic": "JK_TALK_FRIEND_CONVERSATION_1",
        "switch": true,
        "condition": { "compare_string": [ "done", { "npc_val": "n_jk_told_backstory" } ] }
      },
      { "text": "(場所を移してからにしよう)", "topic": "TALK_NONE" },
      { "text": "(会話を終える)", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": [ "JK_TALK_ALLY_ORDERS" ],
    "type": "talk_topic",
    "dynamic_line": [ "はい、センパイ", "どうしました？　センパイ", "何をすればいいですか？", "はい！" ],
    "responses": [
      {
        "text": "(アイテムを取引する)",
        "condition": { "and": [ { "not": { "npc_has_trait": "HALLUCINATION" } }, { "not": "is_by_radio" } ] },
        "topic": "JK_TALK_FRIEND",
        "effect": "start_trade",
        "switch": true,
        "default": true
      },
      {
        "text": "(アイテムを取引する)",
        "topic": "JK_TRADE_HALLU",
        "condition": { "npc_has_trait": "HALLUCINATION" },
        "switch": true,
        "default": false
      },
      {
        "text": "(アイテムを使ってもらう)",
        "condition": { "not": "is_by_radio" },
        "topic": "JK_TALK_FRIEND",
        "effect": "npc_gets_item_to_use"
      },
      {
        "text": "(アイテムを持ってもらう)",
        "condition": { "not": "is_by_radio" },
        "topic": "JK_TALK_FRIEND",
        "effect": "npc_gets_item"
      },
      {
        "text": "(この場を防衛させる)",
        "condition": { "not": "is_by_radio" },
        "topic": "JK_TALK_GUARD",
        "effect": "assign_guard"
      },
      {
        "text": "(騎乗させる)",
        "condition": { "and": [ { "not": "npc_is_riding" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "topic": "TALK_DONE",
        "effect": "find_mount"
      },
      { "text": "(降りてもらう)", "condition": "npc_is_riding", "topic": "TALK_DONE", "effect": "dismount" },
      {
        "text": "(使わないアイテムを落としてもらう)",
        "condition": { "and": [ { "not": "is_by_radio" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "topic": "TALK_DONE",
        "effect": "drop_items_in_place"
      },
      { "text": "(取得ルールについて)", "topic": "TALK_FRIEND", "effect": "set_npc_pickup" },
      { "text": "(今の作業について)", "topic": "JK_TALK_ACTIVITIES" },
      { "text": "(拠点について)", "topic": "JK_TALK_CAMP" },
      { "text": "(戻る)", "topic": "TALK_NONE" },
      { "text": "(会話を終える)", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "JK_TALK_RADIO",
    "type": "talk_topic",
    "responses": [
      { "text": "(移動先を指示する)", "topic": "JK_TALK_GOTO_LOCATION_RADIO", "effect": "goto_location" },
      { "text": "(その場を防衛させる)", "topic": "TALK_DONE", "effect": "assign_guard" },
      {
        "text": "(拠点のためにできることを聞く)",
        "topic": "TALK_DONE",
        "effect": "basecamp_mission",
        "condition": { "npc_at_om_location": "FACTION_CAMP_ANY" }
      }
    ]
  },
  {
    "id": "JK_TALK_DESCRIBE_MISSION",
    "type": "talk_topic",
    "responses": [ { "text": "(了解)", "topic": "TALK_DONE" } ]
  },
  {
    "id": "JK_TALK_ACTIVITIES",
    "type": "talk_topic",
    "dynamic_line": { "npc_has_activity": "今は<current_activity>をしてます", "no": "I'm not doing much currently." },
    "responses": [
      { "text": "(今の目標を聞く)", "topic": "JK_TALK_DESCRIBE_MISSION" },
      { "text": "(続けてもらう)", "topic": "TALK_DONE" },
      {
        "text": "(手を止めてもらう)",
        "topic": "TALK_DONE",
        "condition": "npc_has_activity",
        "effect": "revert_activity"
      },
      {
        "text": "(近くのアイテムを分類してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "sort_loot"
      },
      {
        "text": "(建設区画で建設を頼む)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_construction"
      },
      {
        "text": "(掘削作業を頼む)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_mining"
      },
      {
        "text": "(区画の液体を掃除してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_mopping"
      },
      {
        "text": "(本から学習してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_read"
      },
      {
        "text": "(電子書籍から学習してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_eread"
      },
      {
        "text": "(持っている本で学習してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_read_repeatedly"
      },
      {
        "text": "(区画内の車両を解体してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_vehicle_deconstruct"
      },
      {
        "text": "(区画内の車両を修理してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_vehicle_repair"
      },
      {
        "text": "(丸太から木材を切り出してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_chop_plank"
      },
      {
        "text": "(死体の解体を頼む)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_butcher"
      },
      {
        "text": "(区画の樹木を伐採してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_chop_trees"
      },
      {
        "text": "(釣りを頼む)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_fishing"
      },
      {
        "text": "(農作業を頼む)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_farming"
      },
      {
        "text": "(区画のアイテムを分解してもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_disassembly"
      },
      {
        "text": "(アイテムを作ってもらう)",
        "topic": "TALK_DONE",
        "condition": { "and": [ { "not": "npc_has_activity" }, { "not": { "npc_has_trait": "HALLUCINATION" } } ] },
        "effect": "do_craft"
      }
    ]
  },
  {
    "id": "JK_TALK_GOTO_LOCATION_RADIO",
    "type": "talk_topic",
    "dynamic_line": "...ザザザザ...了解ですセンパイ。指定された場所に向かいます",
    "responses": [ { "text": "(了解)", "topic": "TALK_DONE" } ]
  },
  {
    "id": "JK_TALK_GOTO_LOCATION",
    "type": "talk_topic",
    "dynamic_line": {
      "npc_is_travelling": "はい、センパイ。向かいます",
      "no": "そうですか？　いつでも言ってくださいね！"
    },
    "responses": [ { "text": "(了解)", "topic": "TALK_DONE" } ]
  },
  {
    "id": "JK_TRADE_HALLU",
    "type": "talk_topic",
    "dynamic_line": "(幻覚のため取引できない)",
    "responses": [ { "text": "Fair enough.", "topic": "TALK_NONE" } ]
  },
  {
    "id": "JK_TALK_HALLU_CAMP",
    "type": "talk_topic",
    "dynamic_line": "(幻覚のため拠点の話ができない)",
    "responses": [ { "text": "Fair enough.", "topic": "TALK_NONE" } ]
  },
  {
    "id": "JK_TALK_CAMP_SITES",
    "type": "talk_topic",
    "dynamic_line": { "list_faction_camp_sites": true },
    "responses": [
      { "text": "(拠点についてもっと話す)", "topic": "TALK_NONE" },
      { "text": "(会話を終える)", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "JK_TALK_CAMP",
    "type": "talk_topic",
    "dynamic_line": "拠点がどうしました？",
    "responses": [
      {
        "text": "(この拠点で作業してもらう)",
        "condition": { "npc_at_om_location": "FACTION_CAMP_ANY" },
        "topic": "JK_TALK_GUARD",
        "effect": "assign_camp"
      },
      {
        "text": "(ここに拠点を作る)",
        "topic": "JK_TALK_HALLU_CAMP",
        "condition": { "npc_has_trait": "HALLUCINATION" },
        "switch": true
      },
      {
        "text": "(ここに拠点を作る)",
        "topic": "TALK_DONE",
        "effect": "start_camp",
        "condition": { "npc_at_om_location": "FACTION_CAMP_START" },
        "switch": true,
        "default": true
      },
      {
        "text": "(ここがダメならどこにしたらいいだろう？)",
        "topic": "JK_TALK_CAMP_SITES",
        "condition": { "not": { "npc_at_om_location": "FACTION_CAMP_START" } },
        "switch": true,
        "default": true
      },
      {
        "text": "(この拠点を放棄する)",
        "condition": { "npc_at_om_location": "FACTION_CAMP_ANY" },
        "topic": "JK_TALK_ABANDON"
      },
      {
        "text": "(拠点でやるべきことを聞く)",
        "topic": "TALK_DONE",
        "effect": "basecamp_mission",
        "condition": { "npc_at_om_location": "FACTION_CAMP_ANY" }
      },
      { "text": "(戻る)", "topic": "TALK_NONE" }
    ]
  },
  {
    "id": "JK_TALK_ABANDON",
    "type": "talk_topic",
    "dynamic_line": { "gendered_line": "本当にいいんですか、センパイ？", "relevant_genders": [ "u" ] },
    "responses": [
      { "text": "(拠点を放棄する)", "topic": "TALK_DONE", "effect": "abandon_camp" },
      { "text": "(やめる)", "topic": "TALK_NONE" }
    ]
  },
  {
    "id": "JK_TALK_FRIEND_GUARD",
    "type": "talk_topic",
    "dynamic_line": "あっセンパイ、サボってないですよ。ちゃんとここを守ってます",
    "responses": [
      { "text": "(一緒に行く)", "topic": "JK_TALK_STOP_GUARD", "effect": "stop_guard" },
      { "text": "(話をする)", "topic": "JK_TALK_FRIEND" },
      { "text": "(会話終了)", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "JK_TALK_STOP_GUARD",
    "type": "talk_topic",
    "dynamic_line": "やった！ また一緒に行きましょう",
    "responses": [ { "text": "(会話終了)", "topic": "TALK_DONE" } ]
  }
]
